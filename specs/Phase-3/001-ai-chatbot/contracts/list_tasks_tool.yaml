mcp_tool: list_tasks
version: 1.0.0
description: |
  Retrieve tasks for the authenticated user with optional status filtering.
  Use when user wants to see, view, list, or show their tasks.

parameters:
  type: object
  required:
    - user_id
  properties:
    user_id:
      type: integer
      minimum: 1
      description: ID of the user whose tasks to retrieve (from JWT token)
      example: 5
    status:
      type: string
      nullable: true
      enum: ["all", "pending", "completed"]
      default: "all"
      description: |
        Filter tasks by completion status:
        - "all": Return all tasks (default)
        - "pending": Return only incomplete tasks (completed = false)
        - "completed": Return only completed tasks (completed = true)
      example: "pending"

returns:
  type: object
  required:
    - tasks
    - count
  properties:
    tasks:
      type: array
      description: List of tasks matching the filter criteria
      items:
        type: object
        required:
          - task_id
          - title
          - description
          - completed
          - created_at
        properties:
          task_id:
            type: integer
            example: 42
          title:
            type: string
            example: "Buy milk"
          description:
            type: string
            nullable: true
            example: "Get 2% milk from the grocery store"
          completed:
            type: boolean
            example: false
          created_at:
            type: string
            format: date-time
            example: "2025-12-30T12:00:00Z"
    count:
      type: integer
      description: Total number of tasks returned
      example: 3

errors:
  - code: "USER_NOT_FOUND"
    message: "User not found"
    http_status: 404
    condition: "user_id does not exist in database"
  - code: "INVALID_STATUS"
    message: "Status must be 'all', 'pending', or 'completed'"
    http_status: 422
    condition: "status value not in allowed enum"

examples:
  - name: "List all tasks"
    input:
      user_id: 5
      status: "all"
    output:
      tasks:
        - task_id: 42
          title: "Buy milk"
          description: null
          completed: false
          created_at: "2025-12-30T12:00:00Z"
        - task_id: 43
          title: "Call mom"
          description: null
          completed: true
          created_at: "2025-12-29T10:00:00Z"
      count: 2

  - name: "List pending tasks only"
    input:
      user_id: 5
      status: "pending"
    output:
      tasks:
        - task_id: 42
          title: "Buy milk"
          description: null
          completed: false
          created_at: "2025-12-30T12:00:00Z"
      count: 1

  - name: "List completed tasks only"
    input:
      user_id: 5
      status: "completed"
    output:
      tasks:
        - task_id: 43
          title: "Call mom"
          description: null
          completed: true
          created_at: "2025-12-29T10:00:00Z"
      count: 1

  - name: "No tasks found"
    input:
      user_id: 7
      status: "all"
    output:
      tasks: []
      count: 0

agent_usage:
  trigger_phrases:
    - "Show my tasks"
    - "List my tasks"
    - "What tasks do I have"
    - "What's pending"
    - "Show completed tasks"
    - "What have I finished"
  natural_language_examples:
    - user_input: "Show me all my tasks"
      extracted_parameters:
        status: "all"
    - user_input: "What's pending?"
      extracted_parameters:
        status: "pending"
    - user_input: "Show completed tasks"
      extracted_parameters:
        status: "completed"
    - user_input: "List my tasks"
      extracted_parameters:
        status: "all"  # Default

validation:
  - rule: "user_id must be a positive integer"
    enforcement: "Parameter type validation"
  - rule: "status must be 'all', 'pending', or 'completed' if provided"
    enforcement: "Enum validation"
  - rule: "status defaults to 'all' if omitted"
    enforcement: "Application logic"

security:
  - check: "user_id from parameters MUST match authenticated user from JWT"
    enforcement: "Endpoint-level JWT validation"
    consequence: "403 Forbidden if mismatch"
  - check: "Query MUST filter by user_id (no cross-user data)"
    enforcement: "WHERE user_id = {authenticated_user}"
    consequence: "User isolation enforced at database level"

performance:
  expected_execution_time: "<50ms"
  database_operations: 1
  operation_type: "SELECT FROM tasks WHERE user_id = ? [AND completed = ?]"
  query_optimization: "Index on (user_id, completed) for fast filtering"

idempotency: true
side_effects: "None (read-only operation)"
stateless: true
