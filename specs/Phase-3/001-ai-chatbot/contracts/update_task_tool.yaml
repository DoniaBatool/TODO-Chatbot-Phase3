mcp_tool: update_task
version: 1.0.0
description: |
  Update a task's title and/or description.
  Use when user wants to change, edit, modify, or update task details.

parameters:
  type: object
  required:
    - user_id
    - task_id
  properties:
    user_id:
      type: integer
      minimum: 1
      description: ID of the user who owns the task (from JWT token)
      example: 5
    task_id:
      type: integer
      minimum: 1
      description: ID of the task to update
      example: 42
    title:
      type: string
      nullable: true
      minLength: 1
      maxLength: 200
      description: New task title (optional, omit to keep current)
      example: "Buy milk and eggs"
    description:
      type: string
      nullable: true
      maxLength: 10000
      description: New task description (optional, omit to keep current, null to clear)
      example: "Get 2% milk and a dozen eggs from Whole Foods"

returns:
  type: object
  required:
    - task_id
    - title
    - description
    - completed
    - updated_at
  properties:
    task_id:
      type: integer
      description: ID of the updated task
      example: 42
    title:
      type: string
      description: Updated task title
      example: "Buy milk and eggs"
    description:
      type: string
      nullable: true
      description: Updated task description (null if cleared)
      example: "Get 2% milk and a dozen eggs from Whole Foods"
    completed:
      type: boolean
      description: Completion status (unchanged by update)
      example: false
    updated_at:
      type: string
      format: date-time
      description: ISO 8601 timestamp of update
      example: "2025-12-30T15:00:00Z"

errors:
  - code: "TASK_NOT_FOUND"
    message: "Task not found"
    http_status: 404
    condition: "task_id does not exist OR task belongs to different user"
  - code: "NO_FIELDS_PROVIDED"
    message: "At least one field (title or description) must be provided"
    http_status: 422
    condition: "Both title and description are omitted"
  - code: "TITLE_TOO_LONG"
    message: "Title must be 200 characters or less"
    http_status: 422
    condition: "title length > 200"
  - code: "TITLE_EMPTY"
    message: "Title cannot be empty"
    http_status: 422
    condition: "title provided but is empty string"
  - code: "DESCRIPTION_TOO_LONG"
    message: "Description must be 10000 characters or less"
    http_status: 422
    condition: "description length > 10000"

examples:
  - name: "Update title only"
    input:
      user_id: 5
      task_id: 42
      title: "Buy milk and eggs"
    output:
      task_id: 42
      title: "Buy milk and eggs"
      description: null  # Unchanged (was null)
      completed: false
      updated_at: "2025-12-30T15:00:00Z"

  - name: "Update description only"
    input:
      user_id: 5
      task_id: 42
      description: "Get organic milk from Whole Foods"
    output:
      task_id: 42
      title: "Buy milk"  # Unchanged
      description: "Get organic milk from Whole Foods"
      completed: false
      updated_at: "2025-12-30T15:05:00Z"

  - name: "Update both title and description"
    input:
      user_id: 5
      task_id: 42
      title: "Buy groceries"
      description: "Milk, eggs, bread from Whole Foods"
    output:
      task_id: 42
      title: "Buy groceries"
      description: "Milk, eggs, bread from Whole Foods"
      completed: false
      updated_at: "2025-12-30T15:10:00Z"

  - name: "Clear description (set to null)"
    input:
      user_id: 5
      task_id: 42
      description: null
    output:
      task_id: 42
      title: "Buy milk"  # Unchanged
      description: null  # Cleared
      completed: false
      updated_at: "2025-12-30T15:15:00Z"

  - name: "No fields provided (error)"
    input:
      user_id: 5
      task_id: 42
    error:
      code: "NO_FIELDS_PROVIDED"
      message: "At least one field (title or description) must be provided"

agent_usage:
  trigger_phrases:
    - "Update task"
    - "Change task"
    - "Edit task"
    - "Modify task"
    - "Rename task"
  natural_language_examples:
    - user_input: "Change task 3 to 'Buy milk and eggs'"
      extracted_parameters:
        task_id: 3
        title: "Buy milk and eggs"
    - user_input: "Update the description of task 5 to include deadline"
      agent_behavior: |
        1. Agent asks for the new description text
        2. User provides: "Complete by Friday"
        3. Agent calls update_task with description parameter
    - user_input: "Rename the milk task to 'Buy groceries'"
      agent_behavior: |
        1. Agent calls list_tasks to find task with "milk"
        2. Extracts task_id
        3. Calls update_task with new title

validation:
  - rule: "user_id must be a positive integer"
    enforcement: "Parameter type validation"
  - rule: "task_id must be a positive integer"
    enforcement: "Parameter type validation"
  - rule: "At least one of title or description must be provided"
    enforcement: "Application logic before UPDATE"
  - rule: "If title provided, must be 1-200 characters"
    enforcement: "Length validation"
  - rule: "If description provided, must be â‰¤10000 characters"
    enforcement: "Length validation"

security:
  - check: "user_id from parameters MUST match authenticated user from JWT"
    enforcement: "Endpoint-level JWT validation"
    consequence: "403 Forbidden if mismatch"
  - check: "Task ownership verification"
    enforcement: "WHERE task_id = ? AND user_id = ?"
    consequence: "404 Task not found if ownership mismatch"

performance:
  expected_execution_time: "<50ms"
  database_operations: 1
  operation_type: "UPDATE tasks SET [fields] WHERE id = ? AND user_id = ?"

idempotency: false
idempotency_note: |
  Calling update_task multiple times with same parameters updates updated_at each time.
  However, the title/description values remain the same, so functional idempotency is achieved.
side_effects: "Updates tasks.title and/or tasks.description and tasks.updated_at"
stateless: true
